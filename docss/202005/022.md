# Docker 安装 Jenkins

> 拉取镜像

```shell
docker pull jenkins
```

> 创建 `jenkins` 映射目录 `~/docker/jenkeins`

```shell
mkdir -p ~/docker/jenkins/jenkins_home
```

> 授权

```shell
chown -R 1000 ~/docker/jenkins/jenkins_home
```

> 创建并运行实例

```shell
docker run -d --name jenkins-publish \
-p 8081:8080 -p 50000:50000 \
-v ~/docker/jenkins/jenkins_home:/var/jenkins_home \
--restart=always jenkins
```

> 修改插件下载镜像

修改安装/挂载目录下的 `hudson.model.UpdateCenter.xml` 文件

```shell
vi hudson.model.UpdateCenter.xml
```

```xml
<?xml version='1.0' encoding='UTF-8'?>
<sites>
  <site>
    <id>default</id>
    <url>http://updates.jenkins-ci.org/update-center.json</url>
  </site>
</sites>
```

将 `url` 替换以下三个选一个

`http://mirror.xmission.com/jenkins/updates/update-center.json`

`https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json`

`http://mirror.esuni.jp/jenkins/updates/update-center.json`

重启 `jenkins` 实例

> 登陆 `jenkins`

浏览器访问 `ip:8081` , 显示输入密码，密码路径在容器 `/var/jenkins_home/secrets/initialAdminPassword` 目录

> 登陆容器查看密码

```shell
docker exec -it [实例ID] /bin/bash
```

进入容器，使用以下命令查看密码

```shell
cat /var/jenkins_home/secrets/initialAdminPassword
```

> 登陆 `jenkins`

账号：`Administrator` 

密码：`5e11ccb4e20b4119ac8ee06ae759a026`

- 自定义 `jenkins` 双击选择默认推荐插件 `Install suggested plugins`
- 不管安装成功失败，`continue` 继续，创建用户名密码 `tinycrow/123456`
- 继续，使用 `jenkins`，进入首页